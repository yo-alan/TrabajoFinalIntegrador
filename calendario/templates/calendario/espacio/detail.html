{% extends "admin/base.html" %}

{% block title %}Detalles del espacio {{ espacio }}.{% endblock %}

{% block article %}
	<script>
		$(function (){
			var url = document.location.toString();
			if(url.match('#')) {
				$('.nav-tabs a[href=#'+url.split('#')[1]+']').tab('show') ;
			} 
			
			$('.nav-tabs a').on('shown.bs.tab', function (e){
				window.location.hash = e.target.hash;
				window.scrollTo(0, 0);
			});
		});
		
		function onValChange(object){
			object.value = 10 > object.value ? "0" + object.value : object.value;
		}
		
		function agregar(item){
			var texto = item.children[0].innerHTML;
			
			var eAsignadas = document.getElementById('eAsignadas');
			
			item.setAttribute('onclick', 'eliminar(this)');
			
			eAsignadas.appendChild(item);
		}
		
		function eliminar(item){
			var texto = item.children[0].innerHTML;
			
			var eDisponibles = document.getElementById('eDisponibles');
			
			item.setAttribute('onclick', 'agregar(this)');
			
			eDisponibles.appendChild(item);
		}
		
		function guardar(){
			
			var eAsignadas = document.getElementById('eAsignadas');
			
			for(i = 0; i < eAsignadas.children.length; i++){
				alert(eAsignadas.children[i].id);
			}
			
		}
	</script>
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-12">
				<h3 class="text-center">
					Detalles del espacio {{ espacio }}.
				</h3>
				<div class="tabbable" id="tabs-776256">
					<ul class="nav nav-tabs">
						<li class="active">
							<a href="#atributos" data-toggle="tab">Atributos</a>
						</li>
						<li>
							<a href="#especialidades" data-toggle="tab">Especialidades</a>
						</li>
						<li>
							<a href="#horas" data-toggle="tab">Horas</a>
						</li>
					</ul>
					<div class="tab-content">
						<div class="tab-pane active" id="atributos">
							<div class="col-md-8 col-md-offset-2">
								{% if error_message %}
									<div class="alert alert-danger">
										<a href="#" class="close" data-dismiss="alert">&times;</a>
										<h3 class="text-center text-danger"><b>Ocurrió el siguiente error:</b></h3>
										<p class="text-danger">
											<b>{{ error_message }}</b>
										</p>
									</div>
								{% endif %}
								<form class="form-horizontal" method="POST" action="{% url 'calendario:espacio_edit' espacio.id %}">
									<fieldset>
										<legend class="text-center"><b>Editando a {{ espacio.nombre }}.</b></legend>
										{% csrf_token %}
										<div class="form-group">
											<label class="col-xs-3 control-label" for="nombre">Nombre:</label>
											<div class="col-xs-9">
												<input type="text" id="nombre" name="nombre" class="form-control" value="{{ espacio.nombre }}">
											</div>
										</div>
										<div class="form-group">
											<div class="col-md-offset-8">
												<div class="btn btn-block">
													<a href="{% url 'calendario:espacio_all' %}" class="btn btn-default">
														<< Volver
													</a>
													<button type="submit" class="btn btn-primary">
														Editar
													</button>
												</div>
											</div>
										</div>
									</form>
								</fieldset>
							</div>
						</div>
						<div class="tab-pane" id="especialidades">
							<div class="alert alert-info" role="alert">
								<p><span class="glyphicon glyphicon-info-sign"></span> Para asignar una especialidad hazle clic. Lo mismo para quitarla.</p>
							</div>
							<div class="col-md-11">
								<div class="col-md-offset-1">
									<div class="row">
										<div class="col-md-5">
											<div class="panel panel-primary especialidades">
												<div class="panel-heading">
													<h3 class="panel-title"><b>Disponibles</b></h3>
												</div>
												<ul id="eDisponibles" class="list-group">
													{% for especialidad in especialidades %}
														<li id="{{ especialidad.id }}" class="btn list-group-item" onclick="agregar(this)">
															<p class="text-left">
																{{ especialidad.nombre }}
															</p>
														</li>
													{% endfor %}
												</ul>
											</div>
										</div>
										<div class="col-md-5 col-md-offset-1">
											<div class="panel panel-primary especialidades">
												<div class="panel-heading">
													<h3 class="panel-title"><b>Asignadas</b></h3>
												</div>
												<ul id="eAsignadas" class="list-group">
												</ul>
											</div>
										</div>
									</div>
								</div>
								<button class="btn btn-primary col-md-offset-10" onclick="guardar()">
									Guardar cambios
								</button>
							</div>
						</div>
						<div class="tab-pane" id="horas">
							<div class="col-md-8 col-md-offset-2">
								{% if error_message %}
									<div class="alert alert-danger">
										<a href="#" class="close" data-dismiss="alert">&times;</a>
										<h3 class="text-center text-danger"><b>Ocurrió el siguiente error:</b></h3>
										<p class="text-danger">
											<b>{{ error_message }}</b>
										</p>
									</div>
								{% endif %}
								<form class="form-horizontal col-md-offset-3" method="POST" action="{% url 'calendario:espacio_add_hora' %}">
									<fieldset>
										{% csrf_token %}
										<input id="espacio_id" name="espacio_id" type="hidden" value="{{ espacio.id }}">
										<div class="form-group">
											<div class="row">
												<label class="col-xs-3 control-label" for="desde">Hora desde:</label>
												<div class="col-xs-2">
													<input id="hora_desde" name="hora_desde" type="number" class="form-control" min="00" max="23" value="00" onchange="onValChange(this)">
												</div>
												<div class="col-xs-2">
													<input id="min_desde" name="min_desde" type="number" class="form-control" min="00" max="59" value="00" onchange="onValChange(this)">
												</div>
											</div>
										</div>
										<div class="form-group">
											<div class="row">
												<label class="col-xs-3 control-label" for="hasta">Hora hasta:</label>
												<div class="col-xs-2">
													<input id="hora_hasta" name="hora_hasta" type="number" class="form-control" min="00" max="23" value="00" onchange="onValChange(this)">
												</div>
												<div class="col-xs-2">
													<input id="min_hasta" name="min_hasta" type="number" class="form-control" min="00" max="59" value="00" onchange="onValChange(this)">
												</div>
											</div>
										</div>
										<div class="form-group">
											<div class="col-md-offset-10">
												<button type="submit" class="btn btn-primary">
													Agregar
												</button>
											</div>
										</div>
									</fieldset>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
