{% extends "admin/base.html" %}

{% block title %}Agregar un profesional{% endblock %}

{% block article %}
	<script>
		$(function(){
			
			$("[data-hide]").click(function(){
				$(".alert").attr('class', "alert alert-dismissable alert-danger hidden");
			});
			
			var form = $("#addForm");
			
			form.submit(function (ev){
				
				ev.preventDefault();
				
				$("#btnGuardar").button('loading');
				
				$.ajax({
					url: form.attr('action'),
					type: form.attr('method'),
					data: form.serialize(),
					success: function (response){
						
						$("#btnGuardar").button('reset');
						
						$(".form-group").attr('class', "form-group");
						
						if(response.error){
							
							if(response.campo){
								$("#"+ response.campo + "").parent().parent().attr('class', "form-group has-error");
								$("#"+ response.campo + "").focus();
							}
							
							$(".alert").attr('class', "alert alert-dismissable alert-danger");
							$("#error").html(response.error);
							return;
						}
						
						alert(response.mensaje);
						window.location.href = "{% url 'calendario:profesional_all' %}";
					}
				});
			});
		});
	</script>
	<div class="container-fluid">
		<div class="row clearfix">
			<div class="col-md-6 col-md-offset-3">
				<div class="page-header text-center">
					<h1>
						Agregar profesional<small>.</small>
					</h1>
				</div>
				<div class="alert alert-dismissable alert-danger hidden">
					<button type="button" class="close" data-hide="alert" aria-hidden="true">
						×
					</button>
					<h4>
						Error al guardar el profesional.
					</h4>
					<strong>Ojo!</strong> Un campo no es válido:
					<p id="error">
						
					</p>
				</div>
				<form class="form-horizontal" id="addForm" name="addForm" method="POST" action="{% url 'calendario:profesional_add' %}">
					{% csrf_token %}
					<div class="form-group">
						<label class="col-xs-3 control-label" for="nombre">Nombre:</label>
						<div class="col-xs-9">
							<input type="text" id="nombre" name="nombre" class="form-control" placeholder="Nombre del profesional">
						</div>
					</div>
					<div class="form-group">
						<label class="col-xs-3 control-label" for="apellido">Apellido:</label>
						<div class="col-xs-9">
							<input type="text" id="apellido" name="apellido" class="form-control" placeholder="Apellido del profesional">
						</div>
					</div>
					<div class="form-group">
						<label class="col-xs-3 control-label" for="cuil">Cuil:</label>
						<div class="col-xs-9">
							<input type="text" id="cuil" name="cuil" class="form-control" placeholder="Número de cuil del profesional">
						</div>
					</div>
					<button type="submit" id="btnGuardar" data-loading-text="Guardando..." class="btn btn-primary pull-right" autocomplete="off">
						Guardar
					</button>
				</form>
			</div>
		</div>
	</div>
{% endblock %}
